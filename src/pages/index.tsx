import type { NextPage } from "next";
import Head from "next/head";
import { useState, useEffect } from "react";
import { trpc } from "../utils/trpc";
import Alert from "./components/alert";
import Stepper from "./components/stepper";
import parameters from "../personalization/parameters.json"
import StepperController from "./components/stepperController";

const Home: NextPage = () => {
  
  const nacionalidades = trpc.formOptions.getAllNationalities.useQuery();
  const [openInitialModal, setOpenInitialModal] = useState<boolean>(true)
  const [currentStep, setCurrentStep] = useState<number>(1);

  const steps = parameters.steps;

  const initialAlert = {
    title: "Indicaciones",
    messages: [
      "1. Los campos marcados con asterisco (*) son obligatorios y deben ser llenados para enviar la solicitud.",
      "2. Debe habilitar las ventanas emergentes en su navegador para visualizar la impresiÃ³n del formulario de su solicitud."
    ]
  }

   const handleClick = (direction:string) => {
    let newStep = currentStep;

    direction === "next" ? newStep++ : newStep--;
    // check if steps are within bounds
    newStep > 0 && newStep <= steps.length && setCurrentStep(newStep);
  };
  

  return (
    <>
      <Head>
        <title>Solicitud de Empleo App</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

       <Alert data-modal-toggle={"defaultModal"} 
       setClose={()=>{setOpenInitialModal(false)}} 
       open={openInitialModal} 
       title={initialAlert.title} 
       messages={initialAlert.messages} 
        />

        {/* Navbar Personalizable */}
        <div className="w-full lg:flex justify-between">
          <img className="w-16 lg:w-32" src={"/Logo.png"} alt="Logo" />
           <div className="w-full">
              <Stepper steps={steps} currentStep={currentStep} stepColor={parameters.stepColor}/>
           </div>
           
        </div>

      <main className="container mx-auto flex min-h-screen flex-col items-center justify-center p-4">

        <h1 className={`text-2xl font-semibold py-6 text-[${parameters.fontColor}]`}>Solicitud Empleo {parameters.company}</h1>
        
        {/* Form Component */}
        
        {/* {nacionalidades?.data?.map(nacionalidad=>{
          if(nacionalidad.Codigo>0)
          return <p className="">{nacionalidad.Descripcion}</p>
        })} */}
      </main>

        <StepperController handleClick={handleClick} currentStep={currentStep} steps={parameters.steps} color={parameters.stepColor}/>

    </>
  );
};

export default Home;


